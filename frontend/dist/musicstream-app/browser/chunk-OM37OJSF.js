import{P as s,a,f as r}from"./chunk-5P6X64GI.js";var n=class i{initialState={status:"stopped",currentTrackId:null,currentTime:0,duration:0,volume:.7,isLoading:!1};playerState=new r(this.initialState);playerState$=this.playerState.asObservable();playlist=[];currentTrackIndex=-1;audioElement=null;constructor(){this.initializeAudio(),console.log("AudioPlayerService initialized")}initializeAudio(){this.audioElement=new Audio,this.audioElement.volume=this.playerState.value.volume,this.audioElement.addEventListener("play",()=>this.onPlay()),this.audioElement.addEventListener("pause",()=>this.onPause()),this.audioElement.addEventListener("ended",()=>this.onEnded()),this.audioElement.addEventListener("timeupdate",()=>this.onTimeUpdate()),this.audioElement.addEventListener("loadedmetadata",()=>this.onLoadedMetadata())}setPlaylist(t){this.playlist=t}play(t,e){this.audioElement&&(this.audioElement.src=t,e&&this.updateState({currentTrackId:e}),this.audioElement.play().catch(o=>{console.error("Erreur lors de la lecture:",o),this.setError()}))}pause(){this.audioElement&&this.audioElement.pause()}stop(){this.audioElement&&(this.audioElement.pause(),this.audioElement.currentTime=0,this.updateState({status:"stopped",currentTime:0}))}setVolume(t){let e=Math.max(0,Math.min(1,t));this.audioElement&&(this.audioElement.volume=e),this.updateState({volume:e})}seek(t){this.audioElement&&(this.audioElement.currentTime=t)}next(){this.currentTrackIndex++,this.currentTrackIndex>=this.playlist.length&&(this.currentTrackIndex=0);let t=this.playlist[this.currentTrackIndex];t&&t.filePath&&(this.play(t.filePath,t.id),console.log("Playing next track:",t.title))}previous(){this.currentTrackIndex--,this.currentTrackIndex<0&&(this.currentTrackIndex=this.playlist.length-1);let t=this.playlist[this.currentTrackIndex];t&&t.filePath&&(this.play(t.filePath,t.id),console.log("Playing previous track:",t.title))}onPlay(){this.updateState({status:"playing"})}onPause(){this.updateState({status:"paused"})}onEnded(){this.updateState({status:"stopped",currentTime:0})}onTimeUpdate(){this.audioElement&&this.updateState({currentTime:this.audioElement.currentTime})}onLoadedMetadata(){this.audioElement&&this.updateState({duration:this.audioElement.duration})}setError(){this.updateState({status:"stopped"})}updateState(t){let e=this.playerState.value;this.playerState.next(a(a({},e),t))}static \u0275fac=function(e){return new(e||i)};static \u0275prov=s({token:i,factory:i.\u0275fac,providedIn:"root"})};export{n as a};
